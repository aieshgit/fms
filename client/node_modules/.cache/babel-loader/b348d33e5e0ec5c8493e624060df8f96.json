{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/akau1902/Web Development/fleet-management-system/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/akau1902/Web Development/fleet-management-system/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import React from\"react\";import ReactDOM from\"react-dom\";import\"./index.css\";import App from\"./App\";import axios from\"axios\";import jwtDecode from\"jwt-decode\";import refreshToken from\"./components/auth/refreshToken\";//import { refreshToken } from \"./components/utilities/Helpers\";\n// gets triggered before each axios request\nimport{jsx as _jsx}from\"react/jsx-runtime\";axios.interceptors.request.use(/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(config){var currentDate,decodedToken,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!(// !config.url.includes(\"user-auth\") &&\n!config.url.includes(\"refresh-token\")&&!config.url.includes(\"login\"))){_context.next=11;break;}currentDate=new Date();decodedToken=jwtDecode(JSON.parse(window.localStorage.getItem(\"auth\")).accessToken);//  console.log(\"Inside interceptor\");\nif(!(decodedToken.exp*1000<currentDate.getTime())){_context.next=10;break;}_context.next=6;return refreshToken();case 6:data=_context.sent;//window.localStorage.setItem(\"auth\", JSON.stringify(data));\nconfig.headers[\"authorization\"]=\"Bearer \"+data.accessToken;_context.next=11;break;case 10:config.headers[\"authorization\"]=\"Bearer \"+JSON.parse(window.localStorage.getItem(\"auth\")).accessToken;case 11:return _context.abrupt(\"return\",config);case 12:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}(),function(error){console.log(error);return Promise.reject(error);});ReactDOM.render(/*#__PURE__*/ /* <React.StrictMode> */_jsx(App,{}),/* </React.StrictMode> */document.getElementById(\"root\"));// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals","map":{"version":3,"sources":["C:/Users/akau1902/Web Development/fleet-management-system/client/src/index.js"],"names":["React","ReactDOM","App","axios","jwtDecode","refreshToken","interceptors","request","use","config","url","includes","currentDate","Date","decodedToken","JSON","parse","window","localStorage","getItem","accessToken","exp","getTime","data","headers","error","console","log","Promise","reject","render","document","getElementById"],"mappings":"2WAAA,MAAOA,CAAAA,KAAP,KAAkB,OAAlB,CACA,MAAOC,CAAAA,QAAP,KAAqB,WAArB,CACA,MAAO,aAAP,CACA,MAAOC,CAAAA,GAAP,KAAgB,OAAhB,CACA,MAAOC,CAAAA,KAAP,KAAkB,OAAlB,CACA,MAAOC,CAAAA,SAAP,KAAsB,YAAtB,CACA,MAAOC,CAAAA,YAAP,KAAyB,gCAAzB,CACA;AAEA;2CACAF,KAAK,CAACG,YAAN,CAAmBC,OAAnB,CAA2BC,GAA3B,0FACE,iBAAOC,MAAP,yJAEI;AACA,CAACA,MAAM,CAACC,GAAP,CAAWC,QAAX,CAAoB,eAApB,CAAD,EACA,CAACF,MAAM,CAACC,GAAP,CAAWC,QAAX,CAAoB,OAApB,CAJL,2BAMQC,WANR,CAMsB,GAAIC,CAAAA,IAAJ,EANtB,CAOUC,YAPV,CAOyBV,SAAS,CAC5BW,IAAI,CAACC,KAAL,CAAWC,MAAM,CAACC,YAAP,CAAoBC,OAApB,CAA4B,MAA5B,CAAX,EAAgDC,WADpB,CAPlC,CAUI;AAVJ,KAWQN,YAAY,CAACO,GAAb,CAAmB,IAAnB,CAA0BT,WAAW,CAACU,OAAZ,EAXlC,iDAayBjB,CAAAA,YAAY,EAbrC,QAaYkB,IAbZ,eAcM;AACAd,MAAM,CAACe,OAAP,CAAe,eAAf,EAAkC,UAAYD,IAAI,CAACH,WAAnD,CAfN,+BAkBMX,MAAM,CAACe,OAAP,CAAe,eAAf,EACE,UACAT,IAAI,CAACC,KAAL,CAAWC,MAAM,CAACC,YAAP,CAAoBC,OAApB,CAA4B,MAA5B,CAAX,EAAgDC,WAFlD,CAlBN,wCAuBSX,MAvBT,yDADF,+DA0BE,SAACgB,KAAD,CAAW,CACTC,OAAO,CAACC,GAAR,CAAYF,KAAZ,EACA,MAAOG,CAAAA,OAAO,CAACC,MAAR,CAAeJ,KAAf,CAAP,CACD,CA7BH,EAgCAxB,QAAQ,CAAC6B,MAAT,eACE,wBACA,KAAC,GAAD,IAFF,CAGE,yBACAC,QAAQ,CAACC,cAAT,CAAwB,MAAxB,CAJF,EAOA;AACA;AACA","sourcesContent":["import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport App from \"./App\";\nimport axios from \"axios\";\nimport jwtDecode from \"jwt-decode\";\nimport refreshToken from \"./components/auth/refreshToken\";\n//import { refreshToken } from \"./components/utilities/Helpers\";\n\n// gets triggered before each axios request\naxios.interceptors.request.use(\n  async (config) => {\n    if (\n      // !config.url.includes(\"user-auth\") &&\n      !config.url.includes(\"refresh-token\") &&\n      !config.url.includes(\"login\")\n    ) {\n      let currentDate = new Date();\n      const decodedToken = jwtDecode(\n        JSON.parse(window.localStorage.getItem(\"auth\")).accessToken\n      );\n      //  console.log(\"Inside interceptor\");\n      if (decodedToken.exp * 1000 < currentDate.getTime()) {\n        // get new tokens\n        const data = await refreshToken();\n        //window.localStorage.setItem(\"auth\", JSON.stringify(data));\n        config.headers[\"authorization\"] = \"Bearer \" + data.accessToken;\n      } //if\n      else {\n        config.headers[\"authorization\"] =\n          \"Bearer \" +\n          JSON.parse(window.localStorage.getItem(\"auth\")).accessToken;\n      }\n    } //if\n    return config;\n  },\n  (error) => {\n    console.log(error);\n    return Promise.reject(error);\n  }\n);\n\nReactDOM.render(\n  /* <React.StrictMode> */\n  <App />,\n  /* </React.StrictMode> */\n  document.getElementById(\"root\")\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\n"]},"metadata":{},"sourceType":"module"}