{"ast":null,"code":"var _s = $RefreshSig$();\n\nimport { useEffect, useState, useContext } from \"react\";\nimport axios from \"axios\";\nimport { LoginContext } from \"../context/Context.js\";\nimport { useHistory } from \"react-router-dom\"; //import { SyncOutlined } from \"@nt-design/icons\";\n\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst UserAuth = _ref => {\n  _s();\n\n  let {\n    children\n  } = _ref;\n  let history = useHistory();\n  const [isUserAuth, setUserAuth] = useState(false);\n  const [loginState] = useContext(LoginContext);\n  useEffect(() => {\n    if (loginState && loginState.token) {\n      checkUserAuth();\n    }\n  }, [loginState && loginState.token]);\n\n  const checkUserAuth = async () => {\n    try {\n      const {\n        data\n      } = await axios.get(`http://localhost:5000/user-auth`, {\n        headers: {\n          Authorization: `Bearer ${loginState.token}`\n        }\n      });\n\n      if (data.ok) {\n        setUserAuth(true);\n      }\n    } catch (err) {\n      history.push(\"/login\");\n    }\n  }; // return !isUserAuth ? (<SyncOutLined spin className= \"d-flex justify-content-center display-1 text-primary p-5/>\")\n  //return !isUserAuth ? false : [children];\n\n\n  return !isUserAuth ? false : /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: children\n  }, void 0, false);\n};\n\n_s(UserAuth, \"biFoAf+t8duA8BkSoDyAYlzb9Lw=\", false, function () {\n  return [useHistory];\n});\n\n_c = UserAuth;\nexport default UserAuth;\n\nvar _c;\n\n$RefreshReg$(_c, \"UserAuth\");","map":{"version":3,"sources":["C:/Users/akau1902/Web Development/fleet-management-system/client/src/components/auth/UserAuth.js"],"names":["useEffect","useState","useContext","axios","LoginContext","useHistory","UserAuth","children","history","isUserAuth","setUserAuth","loginState","token","checkUserAuth","data","get","headers","Authorization","ok","err","push"],"mappings":";;AAAA,SAASA,SAAT,EAAoBC,QAApB,EAA8BC,UAA9B,QAAgD,OAAhD;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,SAASC,YAAT,QAA6B,uBAA7B;AACA,SAASC,UAAT,QAA2B,kBAA3B,C,CACA;;;;;AAEA,MAAMC,QAAQ,GAAG,QAAkB;AAAA;;AAAA,MAAjB;AAAEC,IAAAA;AAAF,GAAiB;AACjC,MAAIC,OAAO,GAAGH,UAAU,EAAxB;AACA,QAAM,CAACI,UAAD,EAAaC,WAAb,IAA4BT,QAAQ,CAAC,KAAD,CAA1C;AACA,QAAM,CAACU,UAAD,IAAeT,UAAU,CAACE,YAAD,CAA/B;AAEAJ,EAAAA,SAAS,CAAC,MAAM;AACd,QAAIW,UAAU,IAAIA,UAAU,CAACC,KAA7B,EAAoC;AAClCC,MAAAA,aAAa;AACd;AACF,GAJQ,EAIN,CAACF,UAAU,IAAIA,UAAU,CAACC,KAA1B,CAJM,CAAT;;AAMA,QAAMC,aAAa,GAAG,YAAY;AAChC,QAAI;AACF,YAAM;AAAEC,QAAAA;AAAF,UAAW,MAAMX,KAAK,CAACY,GAAN,CAAW,iCAAX,EAA6C;AAClEC,QAAAA,OAAO,EAAE;AAAEC,UAAAA,aAAa,EAAG,UAASN,UAAU,CAACC,KAAM;AAA5C;AADyD,OAA7C,CAAvB;;AAGA,UAAIE,IAAI,CAACI,EAAT,EAAa;AACXR,QAAAA,WAAW,CAAC,IAAD,CAAX;AACD;AACF,KAPD,CAOE,OAAOS,GAAP,EAAY;AACZX,MAAAA,OAAO,CAACY,IAAR,CAAa,QAAb;AACD;AACF,GAXD,CAXiC,CAwBjC;AACA;;;AACA,SAAO,CAACX,UAAD,GAAc,KAAd,gBAAsB;AAAA,cAAGF;AAAH,mBAA7B;AACD,CA3BD;;GAAMD,Q;UACUD,U;;;KADVC,Q;AA6BN,eAAeA,QAAf","sourcesContent":["import { useEffect, useState, useContext } from \"react\";\r\nimport axios from \"axios\";\r\nimport { LoginContext } from \"../context/Context.js\";\r\nimport { useHistory } from \"react-router-dom\";\r\n//import { SyncOutlined } from \"@nt-design/icons\";\r\n\r\nconst UserAuth = ({ children }) => {\r\n  let history = useHistory();\r\n  const [isUserAuth, setUserAuth] = useState(false);\r\n  const [loginState] = useContext(LoginContext);\r\n\r\n  useEffect(() => {\r\n    if (loginState && loginState.token) {\r\n      checkUserAuth();\r\n    }\r\n  }, [loginState && loginState.token]);\r\n\r\n  const checkUserAuth = async () => {\r\n    try {\r\n      const { data } = await axios.get(`http://localhost:5000/user-auth`, {\r\n        headers: { Authorization: `Bearer ${loginState.token}` },\r\n      });\r\n      if (data.ok) {\r\n        setUserAuth(true);\r\n      }\r\n    } catch (err) {\r\n      history.push(\"/login\");\r\n    }\r\n  };\r\n\r\n  // return !isUserAuth ? (<SyncOutLined spin className= \"d-flex justify-content-center display-1 text-primary p-5/>\")\r\n  //return !isUserAuth ? false : [children];\r\n  return !isUserAuth ? false : <>{children}</>;\r\n};\r\n\r\nexport default UserAuth;\r\n"]},"metadata":{},"sourceType":"module"}