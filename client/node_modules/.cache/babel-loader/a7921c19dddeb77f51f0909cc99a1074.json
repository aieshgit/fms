{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/akau1902/Web Development/fleet-management-system/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/akau1902/Web Development/fleet-management-system/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"C:/Users/akau1902/Web Development/fleet-management-system/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from\"react\";import axios from\"axios\";import UserAuth from\"../auth/UserAuth\";import FileDownload from\"js-file-download\";import{jsx as _jsx}from\"react/jsx-runtime\";var Documents=function Documents(props){var parentDbId=props.parentDbId;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),documents=_useState2[0],setDocuments=_useState2[1];//mount\nuseEffect(function(){// console.log(\"first use effect\");\nloadDocuments();},[]);/*   //update\r\n  useEffect(() => {\r\n    console.log(\"second use effect\");\r\n    loadDocuments();\r\n  }, [documents.length]); */var loadDocuments=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var result;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return axios.get(// `http://localhost:5000/documents/${parentDbId}`\n\"\".concat(process.env.REACT_APP_BACKEND_SERVER,\"/documents/\").concat(parentDbId),{// headers: { Authorization: `Bearer ${loginState.token}` },\nheaders:{authorization:\"Bearer \".concat(JSON.parse(window.localStorage.getItem(\"auth\")).token)}});case 2:result=_context.sent;setDocuments(result.data);case 4:case\"end\":return _context.stop();}}},_callee);}));return function loadDocuments(){return _ref.apply(this,arguments);};}();var handleDownload=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(e,fileName){var file;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:e.preventDefault();_context2.next=3;return axios.get(// `http://localhost:5000/documents/${parentDbId}`\n\"\".concat(process.env.REACT_APP_BACKEND_SERVER,\"/download/\").concat(fileName),{responseType:\"blob\"},{// headers: { Authorization: `Bearer ${loginState.token}` },\nheaders:{authorization:\"Bearer \".concat(JSON.parse(window.localStorage.getItem(\"auth\")).token)}});case 3:file=_context2.sent;FileDownload(file.data,fileName);case 5:case\"end\":return _context2.stop();}}},_callee2);}));return function handleDownload(_x,_x2){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsx(UserAuth,{children:/*#__PURE__*/_jsx(\"div\",{className:\"row\",children:documents.map(function(document,index){return/*#__PURE__*/_jsx(\"div\",{className:\"col-lg-3\",children:/*#__PURE__*/_jsx(\"a\",{// href={`${process.env.REACT_APP_FILE_SERVER}/${document.fileName}`}\nhref:\"javascript\"// target=\"_blank\"\n//  rel=\"noopener noreferrer\"\n// download\n,onClick:function onClick(e){return handleDownload(e,document.fileName);},children:document.fileName})},index);})})});};export default Documents;","map":{"version":3,"sources":["C:/Users/akau1902/Web Development/fleet-management-system/client/src/components/list_comps/Documents.js"],"names":["React","useState","useEffect","axios","UserAuth","FileDownload","Documents","props","parentDbId","documents","setDocuments","loadDocuments","get","process","env","REACT_APP_BACKEND_SERVER","headers","authorization","JSON","parse","window","localStorage","getItem","token","result","data","handleDownload","e","fileName","preventDefault","responseType","file","map","document","index"],"mappings":"kiBAAA,MAAOA,CAAAA,KAAP,EAAgBC,QAAhB,CAA0BC,SAA1B,KAA2C,OAA3C,CACA,MAAOC,CAAAA,KAAP,KAAkB,OAAlB,CACA,MAAOC,CAAAA,QAAP,KAAqB,kBAArB,CACA,MAAOC,CAAAA,YAAP,KAAyB,kBAAzB,C,2CAEA,GAAMC,CAAAA,SAAS,CAAG,QAAZA,CAAAA,SAAY,CAACC,KAAD,CAAW,CAC3B,GAAMC,CAAAA,UAAU,CAAGD,KAAK,CAACC,UAAzB,CAEA,cAAkCP,QAAQ,CAAC,EAAD,CAA1C,wCAAOQ,SAAP,eAAkBC,YAAlB,eAEA;AACAR,SAAS,CAAC,UAAM,CACd;AACAS,aAAa,GACd,CAHQ,CAGN,EAHM,CAAT,CAKA;AACF;AACA;AACA;AACA,4BAEE,GAAMA,CAAAA,aAAa,0FAAG,oKACCR,CAAAA,KAAK,CAACS,GAAN,CACnB;AADmB,UAEhBC,OAAO,CAACC,GAAR,CAAYC,wBAFI,uBAEkCP,UAFlC,EAGnB,CACE;AACAQ,OAAO,CAAE,CACPC,aAAa,kBACXC,IAAI,CAACC,KAAL,CAAWC,MAAM,CAACC,YAAP,CAAoBC,OAApB,CAA4B,MAA5B,CAAX,EAAgDC,KADrC,CADN,CAFX,CAHmB,CADD,QACdC,MADc,eAapBd,YAAY,CAACc,MAAM,CAACC,IAAR,CAAZ,CAboB,sDAAH,kBAAbd,CAAAA,aAAa,0CAAnB,CAgBA,GAAMe,CAAAA,cAAc,2FAAG,kBAAOC,CAAP,CAAUC,QAAV,+HACrBD,CAAC,CAACE,cAAF,GADqB,uBAEF1B,CAAAA,KAAK,CAACS,GAAN,CACjB;AADiB,UAEdC,OAAO,CAACC,GAAR,CAAYC,wBAFE,sBAEmCa,QAFnC,EAGjB,CAAEE,YAAY,CAAE,MAAhB,CAHiB,CAIjB,CACE;AACAd,OAAO,CAAE,CACPC,aAAa,kBACXC,IAAI,CAACC,KAAL,CAAWC,MAAM,CAACC,YAAP,CAAoBC,OAApB,CAA4B,MAA5B,CAAX,EAAgDC,KADrC,CADN,CAFX,CAJiB,CAFE,QAEfQ,IAFe,gBAerB1B,YAAY,CAAC0B,IAAI,CAACN,IAAN,CAAYG,QAAZ,CAAZ,CAfqB,wDAAH,kBAAdF,CAAAA,cAAc,iDAApB,CAkBA,mBACE,KAAC,QAAD,wBACE,YAAK,SAAS,CAAC,KAAf,UACGjB,SAAS,CAACuB,GAAV,CAAc,SAACC,QAAD,CAAWC,KAAX,qBACb,YAAK,SAAS,CAAC,UAAf,uBACE,UACE;AACA,IAAI,CAAC,YACL;AACA;AACA;AALF,CAME,OAAO,CAAE,iBAACP,CAAD,QAAOD,CAAAA,cAAc,CAACC,CAAD,CAAIM,QAAQ,CAACL,QAAb,CAArB,EANX,UAQGK,QAAQ,CAACL,QARZ,EADF,EAA+BM,KAA/B,CADa,EAAd,CADH,EADF,EADF,CAoBD,CAvED,CAyEA,cAAe5B,CAAAA,SAAf","sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport axios from \"axios\";\r\nimport UserAuth from \"../auth/UserAuth\";\r\nimport FileDownload from \"js-file-download\";\r\n\r\nconst Documents = (props) => {\r\n  const parentDbId = props.parentDbId;\r\n\r\n  const [documents, setDocuments] = useState([]);\r\n\r\n  //mount\r\n  useEffect(() => {\r\n    // console.log(\"first use effect\");\r\n    loadDocuments();\r\n  }, []);\r\n\r\n  /*   //update\r\n  useEffect(() => {\r\n    console.log(\"second use effect\");\r\n    loadDocuments();\r\n  }, [documents.length]); */\r\n\r\n  const loadDocuments = async () => {\r\n    const result = await axios.get(\r\n      // `http://localhost:5000/documents/${parentDbId}`\r\n      `${process.env.REACT_APP_BACKEND_SERVER}/documents/${parentDbId}`,\r\n      {\r\n        // headers: { Authorization: `Bearer ${loginState.token}` },\r\n        headers: {\r\n          authorization: `Bearer ${\r\n            JSON.parse(window.localStorage.getItem(\"auth\")).token\r\n          }`,\r\n        },\r\n      }\r\n    );\r\n    setDocuments(result.data);\r\n  };\r\n\r\n  const handleDownload = async (e, fileName) => {\r\n    e.preventDefault();\r\n    const file = await axios.get(\r\n      // `http://localhost:5000/documents/${parentDbId}`\r\n      `${process.env.REACT_APP_BACKEND_SERVER}/download/${fileName}`,\r\n      { responseType: \"blob\" },\r\n      {\r\n        // headers: { Authorization: `Bearer ${loginState.token}` },\r\n        headers: {\r\n          authorization: `Bearer ${\r\n            JSON.parse(window.localStorage.getItem(\"auth\")).token\r\n          }`,\r\n        },\r\n      }\r\n    );\r\n    FileDownload(file.data, fileName);\r\n  };\r\n\r\n  return (\r\n    <UserAuth>\r\n      <div className=\"row\">\r\n        {documents.map((document, index) => (\r\n          <div className=\"col-lg-3\" key={index}>\r\n            <a\r\n              // href={`${process.env.REACT_APP_FILE_SERVER}/${document.fileName}`}\r\n              href=\"javascript\"\r\n              // target=\"_blank\"\r\n              //  rel=\"noopener noreferrer\"\r\n              // download\r\n              onClick={(e) => handleDownload(e, document.fileName)}\r\n            >\r\n              {document.fileName}\r\n            </a>\r\n          </div>\r\n        ))}\r\n      </div>\r\n    </UserAuth>\r\n  );\r\n};\r\n\r\nexport default Documents;\r\n"]},"metadata":{},"sourceType":"module"}