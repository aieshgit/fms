{"ast":null,"code":"var _s = $RefreshSig$();\n\nimport { useEffect, useState, useContext } from \"react\";\nimport axios from \"axios\";\nimport { LoginContext } from \"../context/Context.js\";\nimport { useHistory } from \"react-router-dom\"; //import { SyncOutlined } from \"@nt-design/icons\";\n\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst UserAuth = _ref => {\n  _s();\n\n  let {\n    children\n  } = _ref;\n  let history = useHistory();\n  const [isUserAuth, setUserAuth] = useState(false);\n  const [loginState] = useContext(LoginContext);\n  useEffect(() => {\n    // if (loginState && loginState.token) {\n    checkUserAuth(); //  }\n    //}, [loginState && loginState.token]);\n  }, []);\n\n  const checkUserAuth = async () => {\n    try {\n      // console.log(\"hello there\");\n      //  console.log(\"checkUserAuthToken 1: \" + loginState.token);\n      //let varLocalStorage = JSON.parse(window.localStorage.getItem(\"auth\"));\n      const {\n        data\n      } = await axios.get(`${process.env.REACT_APP_BACKEND_SERVER}/user-auth`, {\n        // headers: { Authorization: `Bearer ${loginState.token}` },\n        headers: {\n          authorization: `Bearer ${JSON.parse(window.localStorage.getItem(\"auth\")).token}`\n        }\n      });\n\n      if (data.ok) {\n        setUserAuth(true);\n      }\n    } catch (err) {\n      history.push(\"/login\");\n    }\n  }; // return !isUserAuth ? (<SyncOutLined spin className= \"d-flex justify-content-center display-1 text-primary p-5/>\")\n  //return !isUserAuth ? false : [children];\n\n\n  return !isUserAuth ? false : /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: children\n  }, void 0, false);\n};\n\n_s(UserAuth, \"biFoAf+t8duA8BkSoDyAYlzb9Lw=\", false, function () {\n  return [useHistory];\n});\n\n_c = UserAuth;\nexport default UserAuth;\n\nvar _c;\n\n$RefreshReg$(_c, \"UserAuth\");","map":{"version":3,"sources":["C:/Users/akau1902/Web Development/fleet-management-system/client/src/components/auth/UserAuth.js"],"names":["useEffect","useState","useContext","axios","LoginContext","useHistory","UserAuth","children","history","isUserAuth","setUserAuth","loginState","checkUserAuth","data","get","process","env","REACT_APP_BACKEND_SERVER","headers","authorization","JSON","parse","window","localStorage","getItem","token","ok","err","push"],"mappings":";;AAAA,SAASA,SAAT,EAAoBC,QAApB,EAA8BC,UAA9B,QAAgD,OAAhD;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,SAASC,YAAT,QAA6B,uBAA7B;AACA,SAASC,UAAT,QAA2B,kBAA3B,C,CACA;;;;;AAEA,MAAMC,QAAQ,GAAG,QAAkB;AAAA;;AAAA,MAAjB;AAAEC,IAAAA;AAAF,GAAiB;AACjC,MAAIC,OAAO,GAAGH,UAAU,EAAxB;AACA,QAAM,CAACI,UAAD,EAAaC,WAAb,IAA4BT,QAAQ,CAAC,KAAD,CAA1C;AACA,QAAM,CAACU,UAAD,IAAeT,UAAU,CAACE,YAAD,CAA/B;AAEAJ,EAAAA,SAAS,CAAC,MAAM;AACd;AACAY,IAAAA,aAAa,GAFC,CAGd;AACA;AACD,GALQ,EAKN,EALM,CAAT;;AAOA,QAAMA,aAAa,GAAG,YAAY;AAChC,QAAI;AACF;AACA;AACA;AACA,YAAM;AAAEC,QAAAA;AAAF,UAAW,MAAMV,KAAK,CAACW,GAAN,CACpB,GAAEC,OAAO,CAACC,GAAR,CAAYC,wBAAyB,YADnB,EAErB;AACE;AACAC,QAAAA,OAAO,EAAE;AACPC,UAAAA,aAAa,EAAG,UACdC,IAAI,CAACC,KAAL,CAAWC,MAAM,CAACC,YAAP,CAAoBC,OAApB,CAA4B,MAA5B,CAAX,EAAgDC,KACjD;AAHM;AAFX,OAFqB,CAAvB;;AAYA,UAAIZ,IAAI,CAACa,EAAT,EAAa;AACXhB,QAAAA,WAAW,CAAC,IAAD,CAAX;AACD;AACF,KAnBD,CAmBE,OAAOiB,GAAP,EAAY;AACZnB,MAAAA,OAAO,CAACoB,IAAR,CAAa,QAAb;AACD;AACF,GAvBD,CAZiC,CAoCjC;AACA;;;AACA,SAAO,CAACnB,UAAD,GAAc,KAAd,gBAAsB;AAAA,cAAGF;AAAH,mBAA7B;AACD,CAvCD;;GAAMD,Q;UACUD,U;;;KADVC,Q;AAyCN,eAAeA,QAAf","sourcesContent":["import { useEffect, useState, useContext } from \"react\";\r\nimport axios from \"axios\";\r\nimport { LoginContext } from \"../context/Context.js\";\r\nimport { useHistory } from \"react-router-dom\";\r\n//import { SyncOutlined } from \"@nt-design/icons\";\r\n\r\nconst UserAuth = ({ children }) => {\r\n  let history = useHistory();\r\n  const [isUserAuth, setUserAuth] = useState(false);\r\n  const [loginState] = useContext(LoginContext);\r\n\r\n  useEffect(() => {\r\n    // if (loginState && loginState.token) {\r\n    checkUserAuth();\r\n    //  }\r\n    //}, [loginState && loginState.token]);\r\n  }, []);\r\n\r\n  const checkUserAuth = async () => {\r\n    try {\r\n      // console.log(\"hello there\");\r\n      //  console.log(\"checkUserAuthToken 1: \" + loginState.token);\r\n      //let varLocalStorage = JSON.parse(window.localStorage.getItem(\"auth\"));\r\n      const { data } = await axios.get(\r\n        `${process.env.REACT_APP_BACKEND_SERVER}/user-auth`,\r\n        {\r\n          // headers: { Authorization: `Bearer ${loginState.token}` },\r\n          headers: {\r\n            authorization: `Bearer ${\r\n              JSON.parse(window.localStorage.getItem(\"auth\")).token\r\n            }`,\r\n          },\r\n        }\r\n      );\r\n\r\n      if (data.ok) {\r\n        setUserAuth(true);\r\n      }\r\n    } catch (err) {\r\n      history.push(\"/login\");\r\n    }\r\n  };\r\n  // return !isUserAuth ? (<SyncOutLined spin className= \"d-flex justify-content-center display-1 text-primary p-5/>\")\r\n  //return !isUserAuth ? false : [children];\r\n  return !isUserAuth ? false : <>{children}</>;\r\n};\r\n\r\nexport default UserAuth;\r\n"]},"metadata":{},"sourceType":"module"}