{"ast":null,"code":"var _s = $RefreshSig$();\n\nimport { useEffect, useState, useContext } from \"react\";\nimport axios from \"axios\";\nimport { LoginContext } from \"../context/Context.js\";\nimport { useHistory } from \"react-router-dom\"; //import { SyncOutlined } from \"@nt-design/icons\";\n\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst UserAuth = _ref => {\n  _s();\n\n  let {\n    children\n  } = _ref;\n  let history = useHistory();\n  const [isUserAuth, setUserAuth] = useState(false);\n  const [loginState] = useContext(LoginContext);\n  useEffect(() => {\n    // if (loginState && loginState.token) {\n    checkUserAuth(); //  }\n    //}, [loginState && loginState.token]);\n  }, []);\n\n  const checkUserAuth = async () => {\n    try {\n      console.log(\"hello there\");\n      const {\n        data\n      } = await axios.get(`http://localhost:5000/user-auth`, {\n        headers: {\n          Authorization: `Bearer ${loginState.token}`\n        }\n      });\n      console.log(\"checkUserAuth: \" + loginState.token);\n\n      if (data.ok) {\n        setUserAuth(true);\n        console.log(\"in try UserAuth: \" + data.ok);\n      }\n\n      console.log(\"in try UserAuth: \" + data.ok);\n    } catch (err) {\n      console.error(err.message);\n      history.push(\"/login\");\n    }\n  };\n\n  console.log(\"in UserAuth: \" + isUserAuth); // return !isUserAuth ? (<SyncOutLined spin className= \"d-flex justify-content-center display-1 text-primary p-5/>\")\n  //return !isUserAuth ? false : [children];\n\n  return !isUserAuth ? false : /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: children\n  }, void 0, false);\n};\n\n_s(UserAuth, \"biFoAf+t8duA8BkSoDyAYlzb9Lw=\", false, function () {\n  return [useHistory];\n});\n\n_c = UserAuth;\nexport default UserAuth;\n\nvar _c;\n\n$RefreshReg$(_c, \"UserAuth\");","map":{"version":3,"sources":["C:/Users/akau1902/Web Development/fleet-management-system/client/src/components/auth/UserAuth.js"],"names":["useEffect","useState","useContext","axios","LoginContext","useHistory","UserAuth","children","history","isUserAuth","setUserAuth","loginState","checkUserAuth","console","log","data","get","headers","Authorization","token","ok","err","error","message","push"],"mappings":";;AAAA,SAASA,SAAT,EAAoBC,QAApB,EAA8BC,UAA9B,QAAgD,OAAhD;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,SAASC,YAAT,QAA6B,uBAA7B;AACA,SAASC,UAAT,QAA2B,kBAA3B,C,CACA;;;;;AAEA,MAAMC,QAAQ,GAAG,QAAkB;AAAA;;AAAA,MAAjB;AAAEC,IAAAA;AAAF,GAAiB;AACjC,MAAIC,OAAO,GAAGH,UAAU,EAAxB;AACA,QAAM,CAACI,UAAD,EAAaC,WAAb,IAA4BT,QAAQ,CAAC,KAAD,CAA1C;AACA,QAAM,CAACU,UAAD,IAAeT,UAAU,CAACE,YAAD,CAA/B;AAEAJ,EAAAA,SAAS,CAAC,MAAM;AACd;AACAY,IAAAA,aAAa,GAFC,CAGd;AACA;AACD,GALQ,EAKN,EALM,CAAT;;AAOA,QAAMA,aAAa,GAAG,YAAY;AAChC,QAAI;AACFC,MAAAA,OAAO,CAACC,GAAR,CAAY,aAAZ;AACA,YAAM;AAAEC,QAAAA;AAAF,UAAW,MAAMZ,KAAK,CAACa,GAAN,CAAW,iCAAX,EAA6C;AAClEC,QAAAA,OAAO,EAAE;AAAEC,UAAAA,aAAa,EAAG,UAASP,UAAU,CAACQ,KAAM;AAA5C;AADyD,OAA7C,CAAvB;AAGAN,MAAAA,OAAO,CAACC,GAAR,CAAY,oBAAoBH,UAAU,CAACQ,KAA3C;;AACA,UAAIJ,IAAI,CAACK,EAAT,EAAa;AACXV,QAAAA,WAAW,CAAC,IAAD,CAAX;AACAG,QAAAA,OAAO,CAACC,GAAR,CAAY,sBAAsBC,IAAI,CAACK,EAAvC;AACD;;AACDP,MAAAA,OAAO,CAACC,GAAR,CAAY,sBAAsBC,IAAI,CAACK,EAAvC;AACD,KAXD,CAWE,OAAOC,GAAP,EAAY;AACZR,MAAAA,OAAO,CAACS,KAAR,CAAcD,GAAG,CAACE,OAAlB;AACAf,MAAAA,OAAO,CAACgB,IAAR,CAAa,QAAb;AACD;AACF,GAhBD;;AAiBAX,EAAAA,OAAO,CAACC,GAAR,CAAY,kBAAkBL,UAA9B,EA7BiC,CA8BjC;AACA;;AACA,SAAO,CAACA,UAAD,GAAc,KAAd,gBAAsB;AAAA,cAAGF;AAAH,mBAA7B;AACD,CAjCD;;GAAMD,Q;UACUD,U;;;KADVC,Q;AAmCN,eAAeA,QAAf","sourcesContent":["import { useEffect, useState, useContext } from \"react\";\r\nimport axios from \"axios\";\r\nimport { LoginContext } from \"../context/Context.js\";\r\nimport { useHistory } from \"react-router-dom\";\r\n//import { SyncOutlined } from \"@nt-design/icons\";\r\n\r\nconst UserAuth = ({ children }) => {\r\n  let history = useHistory();\r\n  const [isUserAuth, setUserAuth] = useState(false);\r\n  const [loginState] = useContext(LoginContext);\r\n\r\n  useEffect(() => {\r\n    // if (loginState && loginState.token) {\r\n    checkUserAuth();\r\n    //  }\r\n    //}, [loginState && loginState.token]);\r\n  }, []);\r\n\r\n  const checkUserAuth = async () => {\r\n    try {\r\n      console.log(\"hello there\");\r\n      const { data } = await axios.get(`http://localhost:5000/user-auth`, {\r\n        headers: { Authorization: `Bearer ${loginState.token}` },\r\n      });\r\n      console.log(\"checkUserAuth: \" + loginState.token);\r\n      if (data.ok) {\r\n        setUserAuth(true);\r\n        console.log(\"in try UserAuth: \" + data.ok);\r\n      }\r\n      console.log(\"in try UserAuth: \" + data.ok);\r\n    } catch (err) {\r\n      console.error(err.message);\r\n      history.push(\"/login\");\r\n    }\r\n  };\r\n  console.log(\"in UserAuth: \" + isUserAuth);\r\n  // return !isUserAuth ? (<SyncOutLined spin className= \"d-flex justify-content-center display-1 text-primary p-5/>\")\r\n  //return !isUserAuth ? false : [children];\r\n  return !isUserAuth ? false : <>{children}</>;\r\n};\r\n\r\nexport default UserAuth;\r\n"]},"metadata":{},"sourceType":"module"}